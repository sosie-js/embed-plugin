/*!
* Install the inline injector manager for the Embed Tool
* @version 4.0.0
* @package https://github.com/sosie-js/embed
*/
class EmbedPlugin{constructor(){}init(e){if(console.log("Embed init plugin starts"),"inject"in e||(e.inject={}),!("Embed"in e.inject)){function t(e,t,o,i,n,l,r){Embed.prepare({config:n});const c=Embed.services,{patterns:s}=(Object.entries(c),Embed.pasteConfig);let d="";const m=Object.keys(c);let u=0;const a=m.length;for(;!d&&u<a;)s[m[u]].test(e)&&(d=m[u]),u+=1;if(e&&d){const s=c[d],{regex:m,embedUrl:u,width:a,height:p,id:g=(e=>e.shift())}=s,f=m.exec(e).slice(1);o={service:d,source:e,embed:u.replace(/<\%\= remote\_id \%\>/g,g(f)),width:a,height:p,caption:o.caption||""};const h=new Embed({data:o,api:i});if(console.log("Insert Block at index block "+l+" and caret "+r+" in mode "+t),"inline"==t){Block.setCaretPosition(l,r);var b=h.render();Block.inlineInjector(b)}else i.blocks.insert("embed",o,n,l,!0)}else e&&alert("No service for this url, check your services config ;\nfor now only "+m.join(",")+" are enabled")}console.log("Embed init plugin : install editor.inject.Embed"),e.inject.Embed=(e,o,i,n,l,r,c)=>{let s=o.source;if(l)if(notifier){function d(e){notifier.show({message:e,layout:"middle",style:"error",time:2e3})}notifier.show({type:"demo",title:"Welcome to the Url Embed injector interactive demo",message:"Type your url ",id:"embed",layout:"left,bottom",url:"",placeholder:"your url",okHandler:function(e){!function(e){console.log("Inject using config",n),t(e.url,e.mode,{source:e.url,caption:e.title},i,n,r,c)}(e)},emptyHandler:function(){d("Sorry but url can not be empty, aborting")},cancelHandler:function(){d("Cancelled")},samples:[{type:"injectbtn",interactive:!1,url:"http://sos-productions.com/7",mode:"inline",custom:!0,title:"I am SoSIE, here are lucky people behind the flags click on it!",text:"Bunny gift"},{type:"injectbtn",interactive:!1,url:"https://vimeo.com/357871593",mode:"block",custom:!1,title:"COMING FOR YOU - Based on a True Story That Affected 100 Million People",text:"Coming 4U"},{type:"injectbtn",interactive:!1,url:"https://youtu.be/E8q2kdTeGzo",mode:"block",custom:!1,title:"Eternal Fifty Minutes | Coming for You II",text:"Eternal 50mn"},{type:"injectbtn",interactive:!1,url:"https://www.youtube.com/watch?v=Mg5budPRY1Q",mode:"block",custom:!1,title:"'Claws of the Red Dragon' exposes connection between Huawei and CCP",text:"ClawsRedDragon"}]})}else s="boolean"==typeof l?prompt("Try your url",s):prompt(l,s),s&&t(s,e,o,i,n,r,c);else t(s,e,o,i,n,r,c)}}console.log("Embed init plugin end")}}var EmbedPlug=new EmbedPlugin;function injectEmbed(e,t,o,i,n){let l=Embed.pasteConfig;n&&(l={services:{youtube:!0,vimeo:!0,bunny:{regex:/https?:\/\/sos-productions.com\/([0-9]+)/,embedUrl:"http://sos-productions.com/share/bunny/index.php?id=<%= remote_id %>#hello",html:"<iframe height='640' scrolling='no' frameborder='no' style='width: 100%;'></iframe>",height:800,width:640}}});let r=document.getElementById("currentPosition").value-1,c=editor.clipboard.blockSelection.in;editor.inject.Embed(i||"inline",{source:e,caption:o},editor,l,t,r,c)}EmbedPlug.init(editor),SoSIE.register("EmbedPlug");